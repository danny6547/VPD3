/* Removes rows from table tempraw whose values for DateTime and IMO are found together on rows of rawdata */

delimiter //

CREATE PROCEDURE insertWithoutDuplicates()
BEGIN

/* An alternative method, which may not be as good for large databases */
/* SELECT * 
FROM tempraw AS t1
LEFT JOIN rawdata AS t2 
ON t1.DateTime_UTC = t2.DateTime_UTC
AND t1.IMO_Vessel_Number = t2.IMO_Vessel_Number
WHERE t2.DateTime_UTC IS NULL; */

INSERT INTO rawdata (DateTime_UTC,IMO_Vessel_Number,Date_UTC,Date_Local,Time_UTC,Time_Local,Voyage_From,Voyage_To,Voyage_Number,Latitude_Degree,Latitude_Minutes,Latitude_North_South,Longitude_Degree,Longitude_Minutes,Longitude_East_West,Wind_Dir,Wind_Force_Kn,Wind_Force_Bft,Sea_state_Dir,Sea_state_Force_Douglas,Swell_Dir,Swell_Force,Current_Dir,Current_Speed,Temperature_Ambient,Temperature_Water,Draft_Actual_Fore,Draft_Actual_Aft,Draft_Recommended_Fore,Draft_Recommended_Aft,Draft_Ballast_Actual,Draft_Ballast_Optimum,Draft_Displacement_Actual,ME_Fuel_BDN,AE_Fuel_BDN,Event,Time_Since_Previous_Report,Time_Elapsed_Sailing,Time_Elapsed_Maneuvering,Time_Elapsed_Waiting,Time_Elapsed_Loading_Unloading,Distance,Nominal_Slip,Apparent_Slip,Cargo_Mt,Cargo_Total_TEU,Cargo_Total_Full_TEU,Cargo_Reefer_TEU,Cargo_CEU,Crew,Passengers,People,ME_Projected_Consumption,ME_Consumption,ME_Cylinder_Oil_Consumption,ME_System_Oil_Consumption,ME_1_Running_Hours,ME_1_Consumption,ME_1_Cylinder_Oil_Consumption,ME_1_System_Oil_Consumption,ME_1_Work,ME_1_Shaft_Power,ME_1_Shaft_Gen_Running_Hours,ME_2_Running_Hours,ME_2_Consumption,ME_2_Cylinder_Oil_Consumption,ME_2_System_Oil_Consumption,ME_2_Work,ME_2_Shaft_Power,ME_2_Shaft_Gen_Running_Hours,AE_Projected_Consumption,AE_Consumption,AE_1_Running_Hours,AE_1_Consumption,AE_1_Work,AE_2_Running_Hours,AE_2_Consumption,AE_2_Work,AE_3_Running_Hours,AE_3_Consumption,AE_3_Work,AE_4_Running_Hours,AE_4_Consumption,AE_4_Work,AE_5_Running_Hours,AE_5_Consumption,AE_5_Work,AE_6_Running_Hours,AE_6_Consumption,AE_6_Work,Boiler_Consumption,Boiler_1_Running_Hours,Boiler_1_Consumption,Boiler_2_Running_Hours,Boiler_2_Consumption,Air_Compr_1_Running_Time,Air_Compr_2_Running_Time,Thruster_1_Running_Time,Thruster_2_Running_Time,Thruster_3_Running_Time,Lube_Oil_System_Type_Of_Pump_In_Service,Cleaning_Event,Mode,Speed_GPS,Speed_Through_Water,Speed_Projected_From_Charter_Party,Water_Depth,ME_Barometric_Pressure,ME_Charge_Air_Coolant_Inlet_Temp,ME_Air_Intake_Temp,ME_1_Load,ME_1_Speed_RPM,Prop_1_Pitch,ME_1_Aux_Blower,ME_1_Shaft_Gen_Power,ME_1_Charge_Air_Inlet_Temp,ME_1_Scav_Air_Pressure,ME_1_Pressure_Drop_Over_Scav_Air_Cooler,ME_1_TC_Speed,ME_1_Exh_Temp_Before_TC,ME_1_Exh_Temp_After_TC,ME_1_Current_Consumption,ME_1_SFOC_ISO_Corrected,ME_1_SFOC,ME_1_Pmax,ME_1_Pcomp,ME_2_Load,ME_2_Speed_RPM,Prop_2_Pitch,ME_2_Aux_Blower,ME_2_Shaft_Gen_Power,ME_2_Charge_Air_Inlet_Temp,ME_2_Scav_Air_Pressure,ME_2_Pressure_Drop_Over_Scav_Air_Cooler,ME_2_TC_Speed,ME_2_Exh_Temp_Before_TC,ME_2_Exh_Temp_After_TC,ME_2_Current_Consumption,ME_2_SFOC_ISO_Corrected,ME_2_SFOC,ME_2_Pmax,ME_2_Pcomp,AE_Barometric_Pressure,AE_Charge_Air_Coolant_Inlet_Temp,AE_Air_Intake_Temp,AE_1_Load,AE_1_Charge_Air_Inlet_Temp,AE_1_Charge_Air_Pressure,AE_1_TC_Speed,AE_1_Exh_Gas_Temperature,AE_1_Current_Consumption,AE_1_SFOC_ISO_Corrected,AE_1_SFOC,AE_1_Pmax,AE_1_Pcomp,AE_2_Load,AE_2_Charge_Air_Inlet_Temp,AE_2_Charge_Air_Pressure,AE_2_TC_Speed,AE_2_Exh_Gas_Temperature,AE_2_Current_Consumption,AE_2_SFOC_ISO_Corrected,AE_2_SFOC,AE_2_Pmax,AE_2_Pcomp,AE_3_Load,AE_3_Charge_Air_Inlet_Temp,AE_3_Charge_Air_Pressure,AE_3_TC_Speed,AE_3_Exh_Gas_Temperature,AE_3_Current_Consumption,AE_3_SFOC_ISO_Corrected,AE_3_SFOC,AE_3_Pmax,AE_3_Pcomp,AE_4_Load,AE_4_Charge_Air_Inlet_Temp,AE_4_Charge_Air_Pressure,AE_4_TC_Speed,AE_4_Exh_Gas_Temperature,AE_4_Current_Consumption,AE_4_SFOC_ISO_Corrected,AE_4_SFOC,AE_4_Pmax,AE_4_Pcomp,AE_5_Load,AE_5_Charge_Air_Inlet_Temp,AE_5_Charge_Air_Pressure,AE_5_TC_Speed,AE_5_Exh_Gas_Temperature,AE_5_Current_Consumption,AE_5_SFOC_ISO_Corrected,AE_5_SFOC,AE_5_Pmax,AE_5_Pcomp,AE_6_Load,AE_6_Charge_Air_Inlet_Temp,AE_6_Charge_Air_Pressure,AE_6_TC_Speed,AE_6_Exh_Gas_Temperature,AE_6_Current_Consumption,AE_6_SFOC_ISO_Corrected,AE_6_SFOC,AE_6_Pmax,AE_6_Pcomp,Boiler_1_Operation_Mode,Boiler_1_Feed_Water_Flow,Boiler_1_Steam_Pressure,Boiler_2_Operation_Mode,Boiler_2_Feed_Water_Flow,Boiler_2_Steam_Pressure,Cooling_Water_System_SW_Pumps_In_Service,Cooling_Water_System_SW_Inlet_Temp,Cooling_Water_System_SW_Outlet_Temp,Cooling_Water_System_Pressure_Drop_Over_Heat_Exchanger,Cooling_Water_System_Pump_Pressure,ER_Ventilation_Fans_In_Service,ER_Ventilation_Waste_Air_Temp,Remarks,Entry_Made_By_1,Entry_Made_By_2)
				Select DateTime_UTC,IMO_Vessel_Number,Date_UTC,Date_Local,Time_UTC,Time_Local,Voyage_From,Voyage_To,Voyage_Number,Latitude_Degree,Latitude_Minutes,Latitude_North_South,Longitude_Degree,Longitude_Minutes,Longitude_East_West,Wind_Dir,Wind_Force_Kn,Wind_Force_Bft,Sea_state_Dir,Sea_state_Force_Douglas,Swell_Dir,Swell_Force,Current_Dir,Current_Speed,Temperature_Ambient,Temperature_Water,Draft_Actual_Fore,Draft_Actual_Aft,Draft_Recommended_Fore,Draft_Recommended_Aft,Draft_Ballast_Actual,Draft_Ballast_Optimum,Draft_Displacement_Actual,ME_Fuel_BDN,AE_Fuel_BDN,Event,Time_Since_Previous_Report,Time_Elapsed_Sailing,Time_Elapsed_Maneuvering,Time_Elapsed_Waiting,Time_Elapsed_Loading_Unloading,Distance,Nominal_Slip,Apparent_Slip,Cargo_Mt,Cargo_Total_TEU,Cargo_Total_Full_TEU,Cargo_Reefer_TEU,Cargo_CEU,Crew,Passengers,People,ME_Projected_Consumption,ME_Consumption,ME_Cylinder_Oil_Consumption,ME_System_Oil_Consumption,ME_1_Running_Hours,ME_1_Consumption,ME_1_Cylinder_Oil_Consumption,ME_1_System_Oil_Consumption,ME_1_Work,ME_1_Shaft_Power,ME_1_Shaft_Gen_Running_Hours,ME_2_Running_Hours,ME_2_Consumption,ME_2_Cylinder_Oil_Consumption,ME_2_System_Oil_Consumption,ME_2_Work,ME_2_Shaft_Power,ME_2_Shaft_Gen_Running_Hours,AE_Projected_Consumption,AE_Consumption,AE_1_Running_Hours,AE_1_Consumption,AE_1_Work,AE_2_Running_Hours,AE_2_Consumption,AE_2_Work,AE_3_Running_Hours,AE_3_Consumption,AE_3_Work,AE_4_Running_Hours,AE_4_Consumption,AE_4_Work,AE_5_Running_Hours,AE_5_Consumption,AE_5_Work,AE_6_Running_Hours,AE_6_Consumption,AE_6_Work,Boiler_Consumption,Boiler_1_Running_Hours,Boiler_1_Consumption,Boiler_2_Running_Hours,Boiler_2_Consumption,Air_Compr_1_Running_Time,Air_Compr_2_Running_Time,Thruster_1_Running_Time,Thruster_2_Running_Time,Thruster_3_Running_Time,Lube_Oil_System_Type_Of_Pump_In_Service,Cleaning_Event,Mode,Speed_GPS,Speed_Through_Water,Speed_Projected_From_Charter_Party,Water_Depth,ME_Barometric_Pressure,ME_Charge_Air_Coolant_Inlet_Temp,ME_Air_Intake_Temp,ME_1_Load,ME_1_Speed_RPM,Prop_1_Pitch,ME_1_Aux_Blower,ME_1_Shaft_Gen_Power,ME_1_Charge_Air_Inlet_Temp,ME_1_Scav_Air_Pressure,ME_1_Pressure_Drop_Over_Scav_Air_Cooler,ME_1_TC_Speed,ME_1_Exh_Temp_Before_TC,ME_1_Exh_Temp_After_TC,ME_1_Current_Consumption,ME_1_SFOC_ISO_Corrected,ME_1_SFOC,ME_1_Pmax,ME_1_Pcomp,ME_2_Load,ME_2_Speed_RPM,Prop_2_Pitch,ME_2_Aux_Blower,ME_2_Shaft_Gen_Power,ME_2_Charge_Air_Inlet_Temp,ME_2_Scav_Air_Pressure,ME_2_Pressure_Drop_Over_Scav_Air_Cooler,ME_2_TC_Speed,ME_2_Exh_Temp_Before_TC,ME_2_Exh_Temp_After_TC,ME_2_Current_Consumption,ME_2_SFOC_ISO_Corrected,ME_2_SFOC,ME_2_Pmax,ME_2_Pcomp,AE_Barometric_Pressure,AE_Charge_Air_Coolant_Inlet_Temp,AE_Air_Intake_Temp,AE_1_Load,AE_1_Charge_Air_Inlet_Temp,AE_1_Charge_Air_Pressure,AE_1_TC_Speed,AE_1_Exh_Gas_Temperature,AE_1_Current_Consumption,AE_1_SFOC_ISO_Corrected,AE_1_SFOC,AE_1_Pmax,AE_1_Pcomp,AE_2_Load,AE_2_Charge_Air_Inlet_Temp,AE_2_Charge_Air_Pressure,AE_2_TC_Speed,AE_2_Exh_Gas_Temperature,AE_2_Current_Consumption,AE_2_SFOC_ISO_Corrected,AE_2_SFOC,AE_2_Pmax,AE_2_Pcomp,AE_3_Load,AE_3_Charge_Air_Inlet_Temp,AE_3_Charge_Air_Pressure,AE_3_TC_Speed,AE_3_Exh_Gas_Temperature,AE_3_Current_Consumption,AE_3_SFOC_ISO_Corrected,AE_3_SFOC,AE_3_Pmax,AE_3_Pcomp,AE_4_Load,AE_4_Charge_Air_Inlet_Temp,AE_4_Charge_Air_Pressure,AE_4_TC_Speed,AE_4_Exh_Gas_Temperature,AE_4_Current_Consumption,AE_4_SFOC_ISO_Corrected,AE_4_SFOC,AE_4_Pmax,AE_4_Pcomp,AE_5_Load,AE_5_Charge_Air_Inlet_Temp,AE_5_Charge_Air_Pressure,AE_5_TC_Speed,AE_5_Exh_Gas_Temperature,AE_5_Current_Consumption,AE_5_SFOC_ISO_Corrected,AE_5_SFOC,AE_5_Pmax,AE_5_Pcomp,AE_6_Load,AE_6_Charge_Air_Inlet_Temp,AE_6_Charge_Air_Pressure,AE_6_TC_Speed,AE_6_Exh_Gas_Temperature,AE_6_Current_Consumption,AE_6_SFOC_ISO_Corrected,AE_6_SFOC,AE_6_Pmax,AE_6_Pcomp,Boiler_1_Operation_Mode,Boiler_1_Feed_Water_Flow,Boiler_1_Steam_Pressure,Boiler_2_Operation_Mode,Boiler_2_Feed_Water_Flow,Boiler_2_Steam_Pressure,Cooling_Water_System_SW_Pumps_In_Service,Cooling_Water_System_SW_Inlet_Temp,Cooling_Water_System_SW_Outlet_Temp,Cooling_Water_System_Pressure_Drop_Over_Heat_Exchanger,Cooling_Water_System_Pump_Pressure,ER_Ventilation_Fans_In_Service,ER_Ventilation_Waste_Air_Temp,Remarks,Entry_Made_By_1,Entry_Made_By_2
					FROM tempraw as a
						WHERE NOT EXISTS(Select DateTime_UTC,IMO_Vessel_Number,Date_UTC,Date_Local,Time_UTC,Time_Local,Voyage_From,Voyage_To,Voyage_Number,Latitude_Degree,Latitude_Minutes,Latitude_North_South,Longitude_Degree,Longitude_Minutes,Longitude_East_West,Wind_Dir,Wind_Force_Kn,Wind_Force_Bft,Sea_state_Dir,Sea_state_Force_Douglas,Swell_Dir,Swell_Force,Current_Dir,Current_Speed,Temperature_Ambient,Temperature_Water,Draft_Actual_Fore,Draft_Actual_Aft,Draft_Recommended_Fore,Draft_Recommended_Aft,Draft_Ballast_Actual,Draft_Ballast_Optimum,Draft_Displacement_Actual,ME_Fuel_BDN,AE_Fuel_BDN,Event,Time_Since_Previous_Report,Time_Elapsed_Sailing,Time_Elapsed_Maneuvering,Time_Elapsed_Waiting,Time_Elapsed_Loading_Unloading,Distance,Nominal_Slip,Apparent_Slip,Cargo_Mt,Cargo_Total_TEU,Cargo_Total_Full_TEU,Cargo_Reefer_TEU,Cargo_CEU,Crew,Passengers,People,ME_Projected_Consumption,ME_Consumption,ME_Cylinder_Oil_Consumption,ME_System_Oil_Consumption,ME_1_Running_Hours,ME_1_Consumption,ME_1_Cylinder_Oil_Consumption,ME_1_System_Oil_Consumption,ME_1_Work,ME_1_Shaft_Power,ME_1_Shaft_Gen_Running_Hours,ME_2_Running_Hours,ME_2_Consumption,ME_2_Cylinder_Oil_Consumption,ME_2_System_Oil_Consumption,ME_2_Work,ME_2_Shaft_Power,ME_2_Shaft_Gen_Running_Hours,AE_Projected_Consumption,AE_Consumption,AE_1_Running_Hours,AE_1_Consumption,AE_1_Work,AE_2_Running_Hours,AE_2_Consumption,AE_2_Work,AE_3_Running_Hours,AE_3_Consumption,AE_3_Work,AE_4_Running_Hours,AE_4_Consumption,AE_4_Work,AE_5_Running_Hours,AE_5_Consumption,AE_5_Work,AE_6_Running_Hours,AE_6_Consumption,AE_6_Work,Boiler_Consumption,Boiler_1_Running_Hours,Boiler_1_Consumption,Boiler_2_Running_Hours,Boiler_2_Consumption,Air_Compr_1_Running_Time,Air_Compr_2_Running_Time,Thruster_1_Running_Time,Thruster_2_Running_Time,Thruster_3_Running_Time,Lube_Oil_System_Type_Of_Pump_In_Service,Cleaning_Event,Mode,Speed_GPS,Speed_Through_Water,Speed_Projected_From_Charter_Party,Water_Depth,ME_Barometric_Pressure,ME_Charge_Air_Coolant_Inlet_Temp,ME_Air_Intake_Temp,ME_1_Load,ME_1_Speed_RPM,Prop_1_Pitch,ME_1_Aux_Blower,ME_1_Shaft_Gen_Power,ME_1_Charge_Air_Inlet_Temp,ME_1_Scav_Air_Pressure,ME_1_Pressure_Drop_Over_Scav_Air_Cooler,ME_1_TC_Speed,ME_1_Exh_Temp_Before_TC,ME_1_Exh_Temp_After_TC,ME_1_Current_Consumption,ME_1_SFOC_ISO_Corrected,ME_1_SFOC,ME_1_Pmax,ME_1_Pcomp,ME_2_Load,ME_2_Speed_RPM,Prop_2_Pitch,ME_2_Aux_Blower,ME_2_Shaft_Gen_Power,ME_2_Charge_Air_Inlet_Temp,ME_2_Scav_Air_Pressure,ME_2_Pressure_Drop_Over_Scav_Air_Cooler,ME_2_TC_Speed,ME_2_Exh_Temp_Before_TC,ME_2_Exh_Temp_After_TC,ME_2_Current_Consumption,ME_2_SFOC_ISO_Corrected,ME_2_SFOC,ME_2_Pmax,ME_2_Pcomp,AE_Barometric_Pressure,AE_Charge_Air_Coolant_Inlet_Temp,AE_Air_Intake_Temp,AE_1_Load,AE_1_Charge_Air_Inlet_Temp,AE_1_Charge_Air_Pressure,AE_1_TC_Speed,AE_1_Exh_Gas_Temperature,AE_1_Current_Consumption,AE_1_SFOC_ISO_Corrected,AE_1_SFOC,AE_1_Pmax,AE_1_Pcomp,AE_2_Load,AE_2_Charge_Air_Inlet_Temp,AE_2_Charge_Air_Pressure,AE_2_TC_Speed,AE_2_Exh_Gas_Temperature,AE_2_Current_Consumption,AE_2_SFOC_ISO_Corrected,AE_2_SFOC,AE_2_Pmax,AE_2_Pcomp,AE_3_Load,AE_3_Charge_Air_Inlet_Temp,AE_3_Charge_Air_Pressure,AE_3_TC_Speed,AE_3_Exh_Gas_Temperature,AE_3_Current_Consumption,AE_3_SFOC_ISO_Corrected,AE_3_SFOC,AE_3_Pmax,AE_3_Pcomp,AE_4_Load,AE_4_Charge_Air_Inlet_Temp,AE_4_Charge_Air_Pressure,AE_4_TC_Speed,AE_4_Exh_Gas_Temperature,AE_4_Current_Consumption,AE_4_SFOC_ISO_Corrected,AE_4_SFOC,AE_4_Pmax,AE_4_Pcomp,AE_5_Load,AE_5_Charge_Air_Inlet_Temp,AE_5_Charge_Air_Pressure,AE_5_TC_Speed,AE_5_Exh_Gas_Temperature,AE_5_Current_Consumption,AE_5_SFOC_ISO_Corrected,AE_5_SFOC,AE_5_Pmax,AE_5_Pcomp,AE_6_Load,AE_6_Charge_Air_Inlet_Temp,AE_6_Charge_Air_Pressure,AE_6_TC_Speed,AE_6_Exh_Gas_Temperature,AE_6_Current_Consumption,AE_6_SFOC_ISO_Corrected,AE_6_SFOC,AE_6_Pmax,AE_6_Pcomp,Boiler_1_Operation_Mode,Boiler_1_Feed_Water_Flow,Boiler_1_Steam_Pressure,Boiler_2_Operation_Mode,Boiler_2_Feed_Water_Flow,Boiler_2_Steam_Pressure,Cooling_Water_System_SW_Pumps_In_Service,Cooling_Water_System_SW_Inlet_Temp,Cooling_Water_System_SW_Outlet_Temp,Cooling_Water_System_Pressure_Drop_Over_Heat_Exchanger,Cooling_Water_System_Pump_Pressure,ER_Ventilation_Fans_In_Service,ER_Ventilation_Waste_Air_Temp,Remarks,Entry_Made_By_1,Entry_Made_By_2 FROM rawdata as b
							WHERE a.DateTime_UTC = b.DateTime_UTC and a.IMO_Vessel_Number = b.IMO_Vessel_Number );
            
END;